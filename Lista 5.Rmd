---
title: "Lista 05"
author: "Amanda Lopes; Ana Vaz; Bárbara Maia; Isabel Eirado"
date: "09/12/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Ativando os pacotes

### **Pacotes**

```{r ativando pacotes, echo=TRUE, message=FALSE, warning=FALSE, paged.print=FALSE}
library(readxl)
library(readr)
library(ggplot2)
library(tidyverse)
library(rmarkdown)
library(ggpubr) # P/ plotar o teste de correlação
library (devtools) # P/ instalar pacotes do github
devtools::install_github("cardiomoon/webr") # P/ plotar o gráfico de distribuição do Teste T
library(webr)
```

## Importando o banco de dados

```{r importando os dados, echo=TRUE}
state_const <- read_excel("state_const.xlsx")
States_and_Abbreviations <- read_excel("States and Abbreviations.xlsx")

```

## Manipulando os dados

```{r manipulando os dados com dplyr, echo=TRUE}
constituicoes_testehipotese <-  state_const %>% 
  select(state, constitution_year, current_constitution, total_words, declaration_rights, discrimination) %>% 
  left_join(States_and_Abbreviations, constituicoes_poderes, by = "state")
```

## Visualizando em tabela

```{r}
paged_table (constituicoes_testehipotese)
```

## Testando a hipótese

- {Qual a base dessa hipótese?}

H0: A variação do número de palavras permance a mesma ao longo das mudanças constitucionais.

- Variável: constituicoes_antigas
- Operacionalização: Corresponde à média do número total de palavras de todas as Constituições de cada Estado, excluída a Constituição atual.

H1: Há maior variação no número de palavras das Constituições estaduais correntes, em relação às Constituições anteriores.

- Variável: valor_novas
- Operacionalização: Corresponde ao número de palavras das Constituições Estaduais atuais.

```{r}

# Criando uma coluna com a Média de Palavras das Constituições Estaduais

constituicoes_testehipotese <- constituicoes_testehipotese %>% 
  group_by(state) %>%
  mutate(media_total_words = mean(total_words)) 

# Operacionalizando a variável media_antigas

constituicoes_antigas <- constituicoes_testehipotese %>% 
  filter(current_constitution == 0) %>%
  group_by(state) %>%
  mutate(media_total_words = mean(total_words)) %>% 
  select(state, media_total_words) %>% 
  group_by(state, media_total_words) %>%
  summarise(n())

media_antigas <- constituicoes_antigas$media_total_words

# Operacionalizando a variável valor_novas

constituicoes_novas <- constituicoes_testehipotese %>%
  filter(current_constitution == 1) %>%
  select(state, constitution_year, total_words) 

valor_novas <- constituicoes_novas$total_words

```

## Teste T

- {Por que aplicamos o teste T?}

```{r}
t.test(media_antigas, valor_novas, paired = TRUE)

# Plotando a distribuição das médias
plot(t.test(media_antigas,valor_novas, mu = 0))

```

- {O que os resultados nos dizem?}

# Correlação

{Faz sentido verificar a correlação nessa lista?}

```{r}
constituicoes_testehipotese %>%
  ggscatter(x = "declaration_rights", y = "discrimination", add = "reg.line", conf.int = TRUE) + stat_cor(method = "pearson", label.x = 7)
  
```




